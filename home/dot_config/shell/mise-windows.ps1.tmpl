{{- if and .dev_computer (eq .chezmoi.os "windows") -}}
# mise - Modern runtime version manager for Windows
# Handles: node, pnpm, deno, bun, uv, python, go, etc.

# Check if mise is available
if (Get-Command mise -ErrorAction SilentlyContinue) {
    # Activate mise - this handles PATH and completions for all tools
    Invoke-Expression (& mise activate powershell)
    
    # Enable mise completions
    Invoke-Expression (& mise completion powershell)
}

# pnpm global packages setup for Windows
$env:PNPM_HOME = "$env:USERPROFILE\.local\share\pnpm"
$currentPath = $env:PATH -split ';'
if ($env:PNPM_HOME -notin $currentPath) {
    $env:PATH = "$env:PNPM_HOME;$env:PATH"
}
{{- end }}