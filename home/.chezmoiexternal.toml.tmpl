{{- if eq .osid "linux-ubuntu" }}

# Modern CLI Tools
[".local/bin/age"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "FiloSottile/age" (printf "age-*-%s-%s.tar.gz" .chezmoi.os .chezmoi.arch) | quote }}
    executable = true
    path = "age/age"

[".local/bin/age-keygen"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "FiloSottile/age" (printf "age-*-%s-%s.tar.gz" .chezmoi.os .chezmoi.arch) | quote }}
    executable = true
    path = "age/age-keygen"

[".local/bin/croc"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "schollz/croc" "croc_v*_Linux-64bit.tar.gz" | quote }}
    executable = true
    path = "croc"

[".local/bin/cue"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "cue-lang/cue" (printf "cue_v*_%s_%s.tar.gz" .chezmoi.os .chezmoi.arch) | quote }}
    executable = true
    path = "cue"

[".local/bin/eza"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "eza-community/eza" "eza_x86_64-unknown-linux-gnu.tar.gz" | quote }}
    executable = true
    path = "./eza"

[".local/bin/gdu"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "dundee/gdu" (printf "gdu_%s_%s.tgz" .chezmoi.os .chezmoi.arch) | quote }}
    executable = true
    path = "gdu_linux_amd64"

[".local/bin/glow"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "charmbracelet/glow" "glow_*_Linux_x86_64.tar.gz" | quote }}
    executable = true
    stripComponents = 1
    path = "glow"

[".local/bin/golangci-lint"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "golangci/golangci-lint" (printf "golangci-lint-*-%s-%s.tar.gz" .chezmoi.os .chezmoi.arch) | quote }}
    executable = true
    stripComponents = 1
    path = "golangci-lint"

[".local/bin/jless"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "PaulJuliusMartinez/jless" "jless-v*-x86_64-unknown-linux-gnu.zip" | quote }}
    executable = true
    path = "jless"

[".local/bin/nvim"]
    type = "file"
    url = "https://github.com/neovim/neovim/releases/download/stable/nvim-linux-x86_64.appimage"
    refreshPeriod = "672h"
    executable = true

[".local/bin/uv"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "astral-sh/uv" "uv-x86_64-unknown-linux-gnu.tar.gz" | quote }}
    refreshPeriod = "72h"
    executable = true
    path = "uv-x86_64-unknown-linux-gnu/uv"

[".local/bin/delta"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "dandavison/delta" (printf "delta-*-x86_64-unknown-linux-gnu.tar.gz") | quote }}
    executable = true
    stripComponents = 1
    path = "delta"
    refreshPeriod = "168h"

[".local/bin/lazygit"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "jesseduffield/lazygit" (printf "lazygit_*_%s_%s.tar.gz" .chezmoi.os (eq .chezmoi.arch "amd64" | ternary "x86_64" .chezmoi.arch)) | quote }}
    executable = true
    path = "lazygit"
    refreshPeriod = "168h"

[".local/bin/yt-dlp"]
    type = "file"
    url = "https://github.com/yt-dlp/yt-dlp/releases/latest/download/yt-dlp"
    executable = true
    refreshPeriod = "168h"

[".local/bin/jj"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "jj-vcs/jj" "jj-*.0-x86_64-unknown-linux-musl.tar.gz" | quote }}
    executable = true
    path = "./jj"

[".local/bin/carapace"]
    type = "archive-file"
    url = {{ gitHubLatestReleaseAssetURL "carapace-sh/carapace-bin" "carapace-bin_*_linux_amd64.tar.gz" | quote }}
    executable = true
    path = "carapace"
    refreshPeriod = "168h"

{{- end }}

{{- if and (not .ephemeral) (not .headless) }}
{{-   $fontDir := "" }}
{{-   if eq .chezmoi.os "darwin" }}
{{-     $fontDir = "Library/Fonts" }}
{{-   else if eq .chezmoi.os "linux" }}
{{-     $fontDir = ".local/share/fonts" }}
{{-   end }}
{{- /* Windows: fonts installed via Scoop in run_onchange_before_01-install-scoop.ps1 */ -}}
{{-   if ne $fontDir "" }}
{{-   range (list
        "MesloLGS NF Regular.ttf"
        "MesloLGS NF Bold.ttf"
        "MesloLGS NF Italic.ttf"
        "MesloLGS NF Bold Italic.ttf") }}
["{{ $fontDir }}/{{ . }}"]
    type = "file"
    url = "https://github.com/romkatv/powerlevel10k-media/raw/master/{{ . }}"
    refreshPeriod = "168h"
{{-   end }}
{{-   end }}
{{- end }}


[".oh-my-zsh"]
    type = "archive"
    url = "https://github.com/ohmyzsh/ohmyzsh/archive/master.tar.gz"
    exact = true
    stripComponents = 1
    refreshPeriod = "168h"
    exclude = [
        "*/.*",
        "*/templates",
        "*/themes",
    ]

# Essential Zsh plugins via .chezmoiexternal (simpler than Zinit for basic plugins)

[".oh-my-zsh/custom/plugins/zsh-active-cheatsheet"]
    type = "archive"
    url = "https://github.com/norsemangrey/zsh-active-cheatsheet/archive/master.tar.gz"
    exact = true
    stripComponents = 1
    refreshPeriod = "168h"
    exclude = [
        "*/.editorconfig",
        "*/.gitattributes",
        "*/.github",
        "*/.gitignore",
        "*/README.md",
    ]

[".oh-my-zsh/custom/themes/powerlevel10k"]
    type = "archive"
    url = "https://github.com/romkatv/powerlevel10k/archive/{{ (gitHubLatestRelease "romkatv/powerlevel10k").TagName }}.tar.gz"
    exact = true
    stripComponents = 1

[".config/tmux/plugins/tpm"]
    type = "archive"
    url = "https://github.com/tmux-plugins/tpm/archive/refs/heads/master.zip"
    exact = true
    stripComponents = 1
    refreshPeriod = "168h"

[".config/tmux/plugins/tmux-sensible"]
    type = "archive"
    url = "https://github.com/tmux-plugins/tmux-sensible/archive/refs/heads/master.zip"
    exact = true
    stripComponents = 1
    refreshPeriod = "168h"

# Zsh Plugin Manager
[".local/share/zinit/zinit.git"]
    type = "git-repo"
    url = "https://github.com/zdharma-continuum/zinit.git"
    refreshPeriod = "168h"

# Claude Code - Hooks from claude-code-mastery
[".claude/hooks"]
    type = "archive"
    url = "https://github.com/TheDecipherist/claude-code-mastery/archive/main.tar.gz"
    stripComponents = 2
    include = ["*/hooks/*"]
    refreshPeriod = "168h"

# Claude Code - Skills from claude-code-mastery (security-audit, commit-messages)
[".claude/skills"]
    type = "archive"
    url = "https://github.com/TheDecipherist/claude-code-mastery/archive/main.tar.gz"
    stripComponents = 2
    include = ["*/skills/**"]
    refreshPeriod = "168h"

# Claude Code - JJ skills from edmundmiller/dotfiles (merges into skills/)
[".claude/skills/jj-history-investigation"]
    type = "archive"
    url = "https://github.com/edmundmiller/dotfiles/archive/main.tar.gz"
    stripComponents = 4
    include = ["*/.claude/skills/jj-history-investigation/**"]
    refreshPeriod = "168h"

[".claude/skills/using-jj-workspaces"]
    type = "archive"
    url = "https://github.com/edmundmiller/dotfiles/archive/main.tar.gz"
    stripComponents = 4
    include = ["*/.claude/skills/using-jj-workspaces/**"]
    refreshPeriod = "168h"
